The for loops are not an elegant solution. Fix TODO. 
